---
title: "Lab 9.6.4"
author: "Team 17"
date: "3/22/2021"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
```

## Lab 9.6.4 SVM with Multiple Classes

To add an extra set of classes for our model, we need to grab the existing data from Lab 9.6.2.

```{r}
x = matrix(rnorm (200 * 2), ncol = 2)
x[1:100,] = x[1:100,] + 2
x[101:150,] = x[101:150,] - 2
y = c(rep(1,150), rep(2,50))
```

If the response is a factor containing more than two levels, then the svm() function will perform multi-class classification using the one-versus-one approach. We explore that setting here by generating a third class of observations.

```{r}
set.seed(1)
x = rbind(x, matrix(rnorm (50 * 2), ncol = 2))
y = c(y, rep(0, 50))
x[y == 0,2] = x[y == 0, 2] + 2
dat = data.frame(x = x, y = as.factor(y))
par(mfrow = c(1,1))
plot(x, col = (y + 1))
```

We now fit an SVM to the data:

```{r}
library(e1071) # Library that contains svm function
svmfit = svm(y~., data = dat, kernel = "radial", cost=10, gamma = 1)
plot(svmfit, dat)

```